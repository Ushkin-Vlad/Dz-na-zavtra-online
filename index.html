<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–ó –Ω–∞ –∑–∞–≤—Ç—Ä–∞!</title>
    <style>
        :root {
            --bg-color: #f0f8ff; --text-color: #333; --header-color: #4a76a8;
            --table-bg: #ffffff; --table-border: #ddd; --button-bg: #4a76a8; --button-color: white;
        }
        .theme-yellow {
            --bg-color: #fffde7; --text-color: #5d4037; --header-color: #ffd54f;
            --table-bg: #ffffff; --table-border: #ffe082; --button-bg: #ffd54f; --button-color: #5d4037;
        }
        .theme-pink {
            --bg-color: #fce4ec; --text-color: #880e4f; --header-color: #f8bbd9;
            --table-bg: #ffffff; --table-border: #f8bbd9; --button-bg: #f8bbd9; --button-color: #880e4f;
        }
        body {
            font-family: Arial, sans-serif; background-color: var(--bg-color); color: var(--text-color);
            margin: 0; padding: 20px; transition: background-color 0.3s, color 0.3s; min-height: 100vh;
        }
        .container { max-width: 900px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 20px; }
        h1 { color: var(--header-color); margin-bottom: 5px; }
        .today-date { font-size: 1.2em; font-weight: bold; margin-bottom: 10px; }
        .theme-buttons { margin: 15px 0; text-align: center; }
        .theme-btn {
            padding: 8px 15px; margin: 0 5px; border: none; border-radius: 5px;
            cursor: pointer; font-weight: bold;
        }
        .theme-default { background: #f0f8ff; color: #333; border: 2px solid #4a76a8; }
        .theme-yellow-btn { background: #fffde7; color: #5d4037; border: 2px solid #ffd54f; }
        .theme-pink-btn { background: #fce4ec; color: #880e4f; border: 2px solid #f8bbd9; }
        .homework-date { text-align: center; font-size: 1.4em; font-weight: bold; margin: 20px 0; color: var(--header-color); }
        .schedule-table {
            width: 100%; border-collapse: collapse; background-color: var(--table-bg);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden; margin-bottom: 20px;
        }
        .schedule-table th, .schedule-table td { border: 1px solid var(--table-border); padding: 12px 15px; text-align: left; }
        .schedule-table th { background-color: var(--header-color); color: var(--button-color); font-weight: bold; }
        .schedule-table tr:nth-child(even) { background-color: rgba(0,0,0,0.03); }
        .subject { font-weight: bold; width: 25%; }
        .lesson-number { width: 10%; text-align: center; }
        .homework { width: 65%; }
        .developer-panel { position: fixed; bottom: 20px; left: 20px; z-index: 1000; }
        .login-btn {
            background-color: var(--button-bg); color: var(--button-color); border: none;
            padding: 10px 15px; border-radius: 5px; cursor: pointer; font-weight: bold;
        }
        .developer-menu {
            display: none; background-color: var(--table-bg); padding: 15px; border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); margin-top: 10px; border: 2px solid var(--header-color);
        }
        .dev-btn {
            padding: 8px 15px; margin: 5px; background-color: var(--header-color);
            color: var(--button-color); border: none; border-radius: 4px; cursor: pointer;
        }
        .edit-mode .homework, .edit-mode .subject {
            cursor: pointer; border: 1px dashed transparent; padding: 4px; border-radius: 3px;
        }
        .edit-mode .homework:hover, .edit-mode .subject:hover {
            border-color: var(--header-color); background-color: rgba(0,0,0,0.05);
        }
        .save-btn {
            display: none; background-color: #4CAF50; color: white; border: none;
            padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; margin: 10px auto;
        }
        .remove-lesson-btn {
            background-color: #f44336; color: white; border: none; padding: 2px 6px;
            border-radius: 3px; cursor: pointer; margin-left: 5px;
        }
        .last-update { text-align: center; margin-top: 20px; font-size: 0.9em; color: #666; }
        .sync-info {
            background: #e3f2fd; padding: 10px; border-radius: 5px; margin: 10px 0;
            border-left: 4px solid #2196F3;
        }
        #loading { text-align: center; padding: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>–î–ó –Ω–∞ –∑–∞–≤—Ç—Ä–∞!</h1>
            <div class="today-date" id="todayDate">–°–µ–≥–æ–¥–Ω—è: </div>
            
            <div class="theme-buttons">
                <button class="theme-btn theme-default" onclick="setTheme('default')">–°–≤–µ—Ç–ª–æ-–≥–æ–ª—É–±–æ–π</button>
                <button class="theme-btn theme-yellow-btn" onclick="setTheme('yellow')">–°–≤–µ—Ç–ª–æ-–∂–µ–ª—Ç—ã–π</button>
                <button class="theme-btn theme-pink-btn" onclick="setTheme('pink')">–°–≤–µ—Ç–ª–æ-—Ä–æ–∑–æ–≤—ã–π</button>
            </div>
        </header>

        <main>
            <div class="homework-date" id="homeworkDate">–ó–∞–¥–∞–Ω–∏—è –Ω–∞ –∑–∞–≤—Ç—Ä–∞: </div>
            
            <div class="sync-info">
                üí° <strong>–ö–∞–∫ –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ:</strong> –ü–æ—Ç—è–Ω–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–Ω–∏–∑ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
            </div>
            
            <div id="loading">üîÑ –ó–∞–≥—Ä—É–∑–∫–∞...</div>
            
            <table class="schedule-table">
                <thead>
                    <tr>
                        <th>‚Ññ</th>
                        <th>–ü—Ä–µ–¥–º–µ—Ç</th>
                        <th>–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ</th>
                        <th class="edit-mode-only" style="display: none;">–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody id="scheduleBody"></tbody>
            </table>

            <div class="last-update" id="lastUpdate"></div>
            <button class="save-btn" id="saveBtn" onclick="saveHomework()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
        </main>
    </div>

    <div class="developer-panel">
        <button class="login-btn" id="loginBtn">üîß –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
        <div class="developer-menu" id="devMenu">
            <div style="margin-bottom: 15px;">
                <strong>–í—Ö–æ–¥ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</strong><br>
                <small>–¢–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</small>
            </div>
            <button class="dev-btn" onclick="enableEditMode()">‚úèÔ∏è –í–∫–ª—é—á–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
            <button class="dev-btn" onclick="addNewLesson()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–∫</button>
            <button class="dev-btn" onclick="resetToDefault()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
            <div style="margin-top: 15px; font-size: 0.9em; color: #666;">
                –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ø—Ä–æ—Å–∏—Ç–µ –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–æ–≤ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const CONFIG = {
            VERSION: '1.0',
            AUTO_SAVE: true,
            SYNC_INTERVAL: 30000 // 30 —Å–µ–∫—É–Ω–¥
        };

        let homeworkData = [];
        let isEditMode = false;
        let lastSavedHash = '';

        // –î–∞–Ω–Ω—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –¥–ª—è –≤—Å–µ—Ö)
        const DEFAULT_SCHEDULE = [
            { subject: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞", task: "‚Ññ100-102", lessonNumber: 1 },
            { subject: "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫", task: "–£–ø—Ä. 45", lessonNumber: 2 },
            { subject: "–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞", task: "–ü—Ä–æ—á–∏—Ç–∞—Ç—å —Å—Ç—Ä. 50-60", lessonNumber: 3 },
            { subject: "–ò—Å—Ç–æ—Ä–∏—è", task: "¬ß18, –≤–æ–ø—Ä–æ—Å—ã 1-5", lessonNumber: 4 },
            { subject: "–ì–µ–æ–≥—Ä–∞—Ñ–∏—è", task: "–ö–æ–Ω—Ç—É—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å—Ç—Ä. 25", lessonNumber: 5 },
            { subject: "–ë–∏–æ–ª–æ–≥–∏—è", task: "–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–æ–∫–ª–∞–¥", lessonNumber: 6 }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            loadHomeworkData();
            updateDates();
            setupEventListeners();
            startAutoSave();
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤–µ—Ä—Å–∏—é –≤ –∫–æ–Ω—Å–æ–ª–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            console.log(`–î–ó –Ω–∞ –∑–∞–≤—Ç—Ä–∞! v${CONFIG.VERSION}`);
        }

        function loadHomeworkData() {
            try {
                const savedData = localStorage.getItem('classHomeworkData');
                if (savedData) {
                    homeworkData = JSON.parse(savedData);
                    console.log('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ localStorage');
                } else {
                    homeworkData = JSON.parse(JSON.stringify(DEFAULT_SCHEDULE));
                    saveHomeworkData();
                    console.log('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é');
                }
                lastSavedHash = generateDataHash();
                updateSchedule();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                homeworkData = JSON.parse(JSON.stringify(DEFAULT_SCHEDULE));
                updateSchedule();
            }
            document.getElementById('loading').style.display = 'none';
        }

        function saveHomeworkData() {
            try {
                localStorage.setItem('classHomeworkData', JSON.stringify(homeworkData));
                localStorage.setItem('lastUpdate', new Date().toLocaleString('ru-RU'));
                lastSavedHash = generateDataHash();
                updateLastUpdateTime();
                console.log('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
            }
        }

        function generateDataHash() {
            return JSON.stringify(homeworkData);
        }

        function hasUnsavedChanges() {
            return generateDataHash() !== lastSavedHash;
        }

        function startAutoSave() {
            setInterval(() => {
                if (isEditMode && hasUnsavedChanges()) {
                    document.getElementById('saveBtn').style.display = 'block';
                }
            }, CONFIG.SYNC_INTERVAL);
        }

        function updateSchedule() {
            const tbody = document.getElementById('scheduleBody');
            if (!tbody) return;

            tbody.innerHTML = '';

            homeworkData.forEach((item, index) => {
                const row = document.createElement('tr');
                
                const numberCell = document.createElement('td');
                numberCell.textContent = item.lessonNumber || (index + 1);
                numberCell.className = 'lesson-number';
                
                const subjectCell = document.createElement('td');
                subjectCell.textContent = item.subject;
                subjectCell.className = 'subject';
                subjectCell.setAttribute('data-index', index);
                
                const homeworkCell = document.createElement('td');
                homeworkCell.textContent = item.task;
                homeworkCell.className = 'homework';
                homeworkCell.setAttribute('data-index', index);

                if (isEditMode) {
                    subjectCell.ondblclick = () => editSubject(index);
                    homeworkCell.ondblclick = () => editHomework(index);
                    
                    const actionsCell = document.createElement('td');
                    actionsCell.innerHTML = `<button class="remove-lesson-btn" onclick="removeLesson(${index})">√ó</button>`;
                    actionsCell.style.display = 'table-cell';
                    row.appendChild(actionsCell);
                }
                
                row.appendChild(numberCell);
                row.appendChild(subjectCell);
                row.appendChild(homeworkCell);
                tbody.appendChild(row);
            });
        }

        function enableEditMode() {
            isEditMode = true;
            document.body.classList.add('edit-mode');
            document.getElementById('devMenu').style.display = 'none';
            document.getElementById('loginBtn').textContent = '‚úèÔ∏è –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è';
            document.getElementById('loginBtn').style.backgroundColor = '#4CAF50';
            updateSchedule();
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
            setTimeout(() => {
                alert('–†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∫–ª—é—á–µ–Ω!\n\nüìù –ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å:\n‚Ä¢ –î–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∏–ª–∏ –∑–∞–¥–∞–Ω–∏–µ\n‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è —É—Ä–æ–∫–æ–≤\n‚Ä¢ –ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è');
            }, 500);
        }

        function editSubject(index) {
            if (!isEditMode) return;
            const newSubject = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞:', homeworkData[index].subject);
            if (newSubject !== null && newSubject.trim() !== '') {
                homeworkData[index].subject = newSubject.trim();
                updateSchedule();
                document.getElementById('saveBtn').style.display = 'block';
            }
        }

        function editHomework(index) {
            if (!isEditMode) return;
            const newTask = prompt('–í–≤–µ–¥–∏—Ç–µ –¥–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ:', homeworkData[index].task);
            if (newTask !== null) {
                homeworkData[index].task = newTask;
                updateSchedule();
                document.getElementById('saveBtn').style.display = 'block';
            }
        }

        function addNewLesson() {
            if (!isEditMode) return;
            const subject = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞:', '–ù–æ–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç');
            if (subject && subject.trim() !== '') {
                homeworkData.push({
                    subject: subject.trim(),
                    task: '–ó–∞–¥–∞–Ω–∏–µ –Ω–µ –∑–∞–¥–∞–Ω–æ',
                    lessonNumber: homeworkData.length + 1
                });
                updateSchedule();
                document.getElementById('saveBtn').style.display = 'block';
            }
        }

        function removeLesson(index) {
            if (!isEditMode) return;
            if (confirm(`–£–¥–∞–ª–∏—Ç—å —É—Ä–æ–∫ "${homeworkData[index].subject}"?`)) {
                homeworkData.splice(index, 1);
                updateSchedule();
                document.getElementById('saveBtn').style.display = 'block';
            }
        }

        function resetToDefault() {
            if (!isEditMode) return;
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é?')) {
                homeworkData = JSON.parse(JSON.stringify(DEFAULT_SCHEDULE));
                updateSchedule();
                document.getElementById('saveBtn').style.display = 'block';
            }
        }

        function saveHomework() {
            saveHomeworkData();
            document.getElementById('saveBtn').style.display = 'none';
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
            alert('‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ!\n\nüì± –ß—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞ –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö:\n1. –°–æ–æ–±—â–∏—Ç–µ –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∞–º\n2. –ü–æ–ø—Ä–æ—Å–∏—Ç–µ –∏—Ö –û–ë–ù–û–í–ò–¢–¨ –°–¢–†–ê–ù–ò–¶–£\n3. –ò–ª–∏ –æ—Ç–∫—Ä—ã—Ç—å —Å–∞–π—Ç –∑–∞–Ω–æ–≤–æ');
        }

        function updateLastUpdateTime() {
            const lastUpdate = localStorage.getItem('lastUpdate');
            const element = document.getElementById('lastUpdate');
            if (element) {
                element.textContent = lastUpdate ?
                    `–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: ${lastUpdate}` : '–ï—â–µ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–æ—Å—å';
            }
        }

        function setTheme(themeName) {
            document.body.className = '';
            if (themeName !== 'default') {
                document.body.classList.add(`theme-${themeName}`);
            }
            localStorage.setItem('selectedTheme', themeName);
        }

        function getNextSchoolDay() {
            const today = new Date();
            let nextDay = new Date(today);
            do {
                nextDay.setDate(nextDay.getDate() + 1);
            } while (nextDay.getDay() === 0 || nextDay.getDay() === 6);
            return nextDay;
        }

        function updateDates() {
            const today = new Date();
            const nextSchoolDay = getNextSchoolDay();
            const options = { day: 'numeric', month: 'long', year: 'numeric', weekday: 'long' };
            
            document.getElementById('todayDate').textContent = `–°–µ–≥–æ–¥–Ω—è: ${today.toLocaleDateString('ru-RU', options)}`;
            
            const dayOfWeek = nextSchoolDay.getDay();
            const dayNames = ['–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ', '–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–≤—Ç–æ—Ä–Ω–∏–∫', '—Å—Ä–µ–¥—É', '—á–µ—Ç–≤–µ—Ä–≥', '–ø—è—Ç–Ω–∏—Ü—É', '—Å—É–±–±–æ—Ç—É'];
            
            document.getElementById('homeworkDate').textContent =
                `–ó–∞–¥–∞–Ω–∏—è –Ω–∞ ${dayNames[dayOfWeek]}: ${nextSchoolDay.toLocaleDateString('ru-RU', options)}`;
        }

        function setupEventListeners() {
            document.getElementById('loginBtn').addEventListener('click', function() {
                const menu = document.getElementById('devMenu');
                menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
            });

            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
            window.addEventListener('beforeunload', function(e) {
                if (hasUnsavedChanges()) {
                    e.preventDefault();
                    e.returnValue = '–£ –≤–∞—Å –µ—Å—Ç—å –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è';
                }
            });
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>